{"ast":null,"code":"import axios from 'axios';\nimport { ElMessage } from 'element-plus';\nimport { onMounted, reactive, ref } from 'vue';\nexport default {\n  __name: 'AddMenus',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = {\n      id: 'id',\n      label: 'label',\n      children: 'subMenus'\n    };\n    const rules = {\n      label: [{\n        required: true,\n        message: '请输入菜单名称',\n        trigger: 'blur'\n      }, {\n        min: 2,\n        max: 20,\n        message: '长度在2到20个字符',\n        trigger: 'blur'\n      }]\n    };\n    const treeNodeList = ref([]);\n    const menuForm = reactive({\n      label: ''\n    });\n    function loadMenuTree() {\n      axios.get(\"http://localhost:8081/listMenus\").then(response => {\n        treeNodeList.value = response.data;\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    onMounted(function () {\n      loadMenuTree();\n    });\n    var id = 0;\n    function hanldNodeClick(node) {\n      console.log(node);\n      id = node.id;\n    }\n    function subMenuForm() {\n      if (id == 0) {\n        ElMessage.warning(\"请先选择父节点\");\n        return;\n      }\n      formRef.value.validate(valid => {\n        if (valid) {\n          menuForm.pid = id;\n          axios.post(\"http://localhost:8081/saveMenus\", menuForm).then(response => {\n            if (response.data.code == 200) {\n              loadMenuTree();\n              resetForm();\n            }\n            ElMessage({\n              message: response.data.msg,\n              type: response.data.code == 200 ? 'success' : 'error'\n            });\n          }).catch(error => {\n            console.log(error);\n            ElMessage.error('保存失败');\n          });\n        }\n      });\n    }\n    function resetForm() {\n      formRef.value.resetFields();\n      id = 0;\n    }\n    const __returned__ = {\n      props,\n      rules,\n      treeNodeList,\n      menuForm,\n      loadMenuTree,\n      get id() {\n        return id;\n      },\n      set id(v) {\n        id = v;\n      },\n      hanldNodeClick,\n      subMenuForm,\n      resetForm,\n      get axios() {\n        return axios;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      onMounted,\n      reactive,\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["axios","ElMessage","onMounted","reactive","ref","props","id","label","children","rules","required","message","trigger","min","max","treeNodeList","menuForm","loadMenuTree","get","then","response","value","data","catch","error","console","log","hanldNodeClick","node","subMenuForm","warning","formRef","validate","valid","pid","post","code","resetForm","msg","type","resetFields"],"sources":["D:/Program/Java QP/Erp/erpfront/src/views/AddMenus.vue"],"sourcesContent":["<template>\r\n  <el-card shadow=\"hover\">\r\n    <template #header>\r\n      <h2>添加菜单</h2>\r\n    </template>\r\n    \r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"12\">\r\n        <el-card shadow=\"never\">\r\n          <template #header>\r\n            <div class=\"card-header\">选择父节点</div>\r\n          </template>\r\n          <el-tree\r\n            :props=\"props\"\r\n            :data=\"treeNodeList\"\r\n            node-key=\"id\"\r\n            ref=\"treeRef\"\r\n            @node-click=\"hanldNodeClick\"\r\n            @check-change=\"hanldNodeChange\"\r\n            highlight-current\r\n          />\r\n        </el-card>\r\n      </el-col>\r\n      \r\n      <el-col :span=\"12\">\r\n        <el-card shadow=\"never\">\r\n          <template #header>\r\n            <div class=\"card-header\">菜单信息</div>\r\n          </template>\r\n          <el-form \r\n            :model=\"menuForm\" \r\n            label-width=\"100px\" \r\n            :rules=\"rules\"\r\n            ref=\"formRef\"\r\n          >\r\n            <el-form-item label=\"菜单名称\" prop=\"label\">\r\n              <el-input \r\n                v-model=\"menuForm.label\" \r\n                placeholder=\"请输入菜单名称\"\r\n              />\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"subMenuForm\">确定</el-button>\r\n              <el-button @click=\"resetForm\">重置</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </el-card>\r\n</template>\r\n\r\n<script setup>\r\nimport axios from 'axios';\r\nimport { ElMessage } from 'element-plus';\r\nimport { onMounted, reactive, ref } from 'vue';\r\n\r\nconst props = {\r\n  id: 'id',\r\n  label: 'label',\r\n  children: 'subMenus'\r\n}\r\n\r\nconst rules = {\r\n  label: [\r\n    { required: true, message: '请输入菜单名称', trigger: 'blur' },\r\n    { min: 2, max: 20, message: '长度在2到20个字符', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\nconst treeNodeList = ref([])\r\nconst menuForm = reactive({\r\n    label:''\r\n})\r\n\r\nfunction loadMenuTree() {\r\n  axios.get(\"http://localhost:8081/listMenus\")\r\n  .then((response)=>{\r\n    treeNodeList.value = response.data\r\n  })\r\n  .catch((error)=>{\r\n    console.log(error)\r\n  })\r\n}\r\n\r\nonMounted(function(){\r\n  loadMenuTree()\r\n})\r\n\r\nvar id=0\r\n\r\nfunction hanldNodeClick(node){\r\n    console.log(node)\r\n    id=node.id\r\n}\r\n\r\nfunction subMenuForm(){\r\n    if(id==0){\r\n        ElMessage.warning(\"请先选择父节点\")\r\n        return\r\n    }\r\n    formRef.value.validate((valid) => {\r\n      if(valid){\r\n        menuForm.pid = id\r\n        axios.post(\"http://localhost:8081/saveMenus\",menuForm)\r\n          .then((response)=>{\r\n            if(response.data.code==200){\r\n              loadMenuTree()\r\n              resetForm()\r\n            }\r\n            ElMessage({\r\n              message: response.data.msg,\r\n              type: response.data.code==200 ? 'success' : 'error'\r\n            })\r\n          })\r\n          .catch((error)=>{\r\n            console.log(error)\r\n            ElMessage.error('保存失败')\r\n          })\r\n      }\r\n    })\r\n}\r\n\r\nfunction resetForm() {\r\n  formRef.value.resetFields()\r\n  id = 0\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.card-header {\r\n  font-weight: bold;\r\n  font-size: 16px;\r\n}\r\n.el-card {\r\n  margin-bottom: 20px;\r\n}\r\n.el-tree {\r\n  min-height: 300px;\r\n}\r\n</style>"],"mappings":"AAqDA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,cAAc;AACxC,SAASC,SAAS,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,KAAK;;;;;;;IAE9C,MAAMC,KAAK,GAAG;MACZC,EAAE,EAAE,IAAI;MACRC,KAAK,EAAE,OAAO;MACdC,QAAQ,EAAE;IACZ,CAAC;IAED,MAAMC,KAAK,GAAG;MACZF,KAAK,EAAE,CACL;QAAEG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,SAAS;QAAEC,OAAO,EAAE;MAAO,CAAC,EACvD;QAAEC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,YAAY;QAAEC,OAAO,EAAE;MAAO,CAAC;IAE/D,CAAC;IAED,MAAMG,YAAY,GAAGX,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMY,QAAQ,GAAGb,QAAQ,CAAC;MACtBI,KAAK,EAAC;IACV,CAAC,CAAC;IAEF,SAASU,YAAYA,CAAA,EAAG;MACtBjB,KAAK,CAACkB,GAAG,CAAC,iCAAiC,CAAC,CAC3CC,IAAI,CAAEC,QAAQ,IAAG;QAChBL,YAAY,CAACM,KAAK,GAAGD,QAAQ,CAACE,IAAI;MACpC,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAG;QACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MACpB,CAAC,CAAC;IACJ;IAEAtB,SAAS,CAAC,YAAU;MAClBe,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC;IAEF,IAAIX,EAAE,GAAC,CAAC;IAER,SAASqB,cAAcA,CAACC,IAAI,EAAC;MACzBH,OAAO,CAACC,GAAG,CAACE,IAAI,CAAC;MACjBtB,EAAE,GAACsB,IAAI,CAACtB,EAAE;IACd;IAEA,SAASuB,WAAWA,CAAA,EAAE;MAClB,IAAGvB,EAAE,IAAE,CAAC,EAAC;QACLL,SAAS,CAAC6B,OAAO,CAAC,SAAS,CAAC;QAC5B;MACJ;MACAC,OAAO,CAACV,KAAK,CAACW,QAAQ,CAAEC,KAAK,IAAK;QAChC,IAAGA,KAAK,EAAC;UACPjB,QAAQ,CAACkB,GAAG,GAAG5B,EAAE;UACjBN,KAAK,CAACmC,IAAI,CAAC,iCAAiC,EAACnB,QAAQ,CAAC,CACnDG,IAAI,CAAEC,QAAQ,IAAG;YAChB,IAAGA,QAAQ,CAACE,IAAI,CAACc,IAAI,IAAE,GAAG,EAAC;cACzBnB,YAAY,CAAC,CAAC;cACdoB,SAAS,CAAC,CAAC;YACb;YACApC,SAAS,CAAC;cACRU,OAAO,EAAES,QAAQ,CAACE,IAAI,CAACgB,GAAG;cAC1BC,IAAI,EAAEnB,QAAQ,CAACE,IAAI,CAACc,IAAI,IAAE,GAAG,GAAG,SAAS,GAAG;YAC9C,CAAC,CAAC;UACJ,CAAC,CAAC,CACDb,KAAK,CAAEC,KAAK,IAAG;YACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;YAClBvB,SAAS,CAACuB,KAAK,CAAC,MAAM,CAAC;UACzB,CAAC,CAAC;QACN;MACF,CAAC,CAAC;IACN;IAEA,SAASa,SAASA,CAAA,EAAG;MACnBN,OAAO,CAACV,KAAK,CAACmB,WAAW,CAAC,CAAC;MAC3BlC,EAAE,GAAG,CAAC;IACR","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}