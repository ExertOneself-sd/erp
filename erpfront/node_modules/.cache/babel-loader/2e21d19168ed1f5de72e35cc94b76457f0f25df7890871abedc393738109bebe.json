{"ast":null,"code":"import axios from 'axios';\nimport { onMounted, ref, reactive } from 'vue';\nimport { ElMessage } from 'element-plus';\n\n// 客户列表数据\n\nexport default {\n  __name: 'ListCustomer',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const custList = ref([]);\n    // 总记录数\n    const total = ref(0);\n    // 当前页码，新增用于跟踪当前所在页码\n    const currentPage = ref(1);\n    // 每页显示数量，新增用于灵活控制每页数量\n    const pageSize = ref(3);\n\n    // 获取客户列表数据，改进参数传递方式\n    function custListQeury(pageNum, pageSize) {\n      return axios.get('http://localhost:8081/listCust', {\n        params: {\n          pageNum,\n          pageSize\n        }\n      }).then(response => {\n        custList.value = response.data.custList;\n        total.value = response.data.total;\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    onMounted(() => {\n      custListQeury(currentPage.value, pageSize.value);\n    });\n\n    // 处理页码切换事件\n    function handlePageChange(newPage) {\n      currentPage.value = newPage;\n      custListQeury(currentPage.value, pageSize.value);\n    }\n\n    // 处理每页显示数量变化事件\n    function handleSizeChange(newSize) {\n      pageSize.value = newSize;\n      currentPage.value = 1; // 当每页数量改变时，重置页码为 1\n      custListQeury(currentPage.value, pageSize.value);\n    }\n    const dialogCustVisible = ref(false);\n    const custFrom = reactive({\n      custName: '',\n      address: '',\n      phone: '',\n      cutType: '',\n      graed: 1,\n      hitTotal: 0\n    });\n    function openCustDialog(row) {\n      dialogCustVisible.value = true;\n      Object.assign(custFrom, row);\n    }\n    function subCustFrom() {\n      axios.post('http://localhost:8081/updatecCust', custFrom).then(respose => {\n        if (respose.data.code == 200) {\n          ElMessage(respose.data.msg);\n          dialogCustVisible.value = false;\n          // 根据当前页码和每页数量重新获取数据，保持当前分页状态\n          custListQeury(currentPage.value, pageSize.value);\n        } else {\n          ElMessage(respose.data.msg);\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    function deleteCust(id) {\n      axios.get('http://localhost:8081/delCust', {\n        params: {\n          id\n        }\n      }).then(respose => {\n        if (respose.data.code == 200) {\n          ElMessage(respose.data.msg);\n          // 根据当前页码和每页数量重新获取数据，保持当前分页状态\n          custListQeury(currentPage.value, pageSize.value);\n        } else {\n          ElMessage(respose.data.msg);\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    const __returned__ = {\n      custList,\n      total,\n      currentPage,\n      pageSize,\n      custListQeury,\n      handlePageChange,\n      handleSizeChange,\n      dialogCustVisible,\n      custFrom,\n      openCustDialog,\n      subCustFrom,\n      deleteCust,\n      get axios() {\n        return axios;\n      },\n      onMounted,\n      ref,\n      reactive,\n      get ElMessage() {\n        return ElMessage;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["axios","onMounted","ref","reactive","ElMessage","custList","total","currentPage","pageSize","custListQeury","pageNum","get","params","then","response","value","data","catch","error","console","log","handlePageChange","newPage","handleSizeChange","newSize","dialogCustVisible","custFrom","custName","address","phone","cutType","graed","hitTotal","openCustDialog","row","Object","assign","subCustFrom","post","respose","code","msg","deleteCust","id"],"sources":["D:/Program/Web QP/vue/erpfront/src/views/ListCustomer.vue"],"sourcesContent":["<template>\n  <h2>客户列表</h2>\n  <el-table :data=\"custList\" style=\"width: 100%\">\n    <!-- 表格列定义保持不变 -->\n    <el-table-column fixed=\"right\" label=\"操作\" width=\"120\">\n      <template #default=\"scope\">\n        <el-button link type=\"primary\" size=\"small\" @click=\"deleteCust(scope.row.id)\">删除</el-button>\n        <el-button link type=\"primary\" size=\"small\" @click=\"openCustDialog(scope.row)\">修改</el-button>\n      </template>\n    </el-table-column>\n  </el-table>\n  <hr />\n  <el-pagination\n    :page-size=\"pageSize\"\n    :pager-count=\"10\"\n    layout=\"prev, pager, next\"\n    :total=\"total\"\n    class=\"mt-4\"\n    @current-change=\"handlePageChange\"\n    @size-change=\"handleSizeChange\"\n  />\n  <el-dialog\n    v-model=\"dialogCustVisible\"\n    width=\"80%\"\n  >\n    <h2>修改客户信息</h2>\n    <el-form :model=\"custFrom\" label-width=\"120px\">\n      <!-- 表单项定义保持不变 -->\n    </el-form>\n  </el-dialog>\n</template>\n\n<script setup>\nimport axios from 'axios';\nimport { onMounted, ref, reactive } from 'vue';\nimport { ElMessage } from 'element-plus';\n\n// 客户列表数据\nconst custList = ref([]);\n// 总记录数\nconst total = ref(0);\n// 当前页码，新增用于跟踪当前所在页码\nconst currentPage = ref(1);\n// 每页显示数量，新增用于灵活控制每页数量\nconst pageSize = ref(3);\n\n// 获取客户列表数据，改进参数传递方式\nfunction custListQeury(pageNum, pageSize) {\n  return axios.get('http://localhost:8081/listCust', {\n    params: {\n      pageNum,\n      pageSize\n    }\n  })\n   .then((response) => {\n      custList.value = response.data.custList;\n      total.value = response.data.total;\n    })\n   .catch((error) => {\n      console.log(error);\n    });\n}\n\nonMounted(() => {\n  custListQeury(currentPage.value, pageSize.value);\n});\n\n// 处理页码切换事件\nfunction handlePageChange(newPage) {\n  currentPage.value = newPage;\n  custListQeury(currentPage.value, pageSize.value);\n}\n\n// 处理每页显示数量变化事件\nfunction handleSizeChange(newSize) {\n  pageSize.value = newSize;\n  currentPage.value = 1; // 当每页数量改变时，重置页码为 1\n  custListQeury(currentPage.value, pageSize.value);\n}\n\nconst dialogCustVisible = ref(false);\nconst custFrom = reactive({\n  custName: '',\n  address: '',\n  phone: '',\n  cutType: '',\n  graed: 1,\n  hitTotal: 0,\n});\n\nfunction openCustDialog(row) {\n  dialogCustVisible.value = true;\n  Object.assign(custFrom, row);\n}\n\nfunction subCustFrom() {\n  axios.post('http://localhost:8081/updatecCust', custFrom)\n   .then((respose) => {\n      if (respose.data.code == 200) {\n        ElMessage(respose.data.msg);\n        dialogCustVisible.value = false;\n        // 根据当前页码和每页数量重新获取数据，保持当前分页状态\n        custListQeury(currentPage.value, pageSize.value);\n      } else {\n        ElMessage(respose.data.msg);\n      }\n    })\n   .catch((error) => {\n      console.log(error);\n    });\n}\n\nfunction deleteCust(id) {\n  axios.get('http://localhost:8081/delCust', {\n    params: {\n      id\n    }\n  })\n   .then((respose) => {\n      if (respose.data.code == 200) {\n        ElMessage(respose.data.msg);\n        // 根据当前页码和每页数量重新获取数据，保持当前分页状态\n        custListQeury(currentPage.value, pageSize.value);\n      } else {\n        ElMessage(respose.data.msg);\n      }\n    })\n   .catch((error) => {\n      console.log(error);\n    });\n}\n</script>\n\n<style scoped>\n/* 组件样式 */\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}