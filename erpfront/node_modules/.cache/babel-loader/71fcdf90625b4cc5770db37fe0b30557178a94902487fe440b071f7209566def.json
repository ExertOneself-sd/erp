{"ast":null,"code":"import axios from 'axios';\nimport { ElMessage } from 'element-plus';\nimport { onMounted, reactive, ref } from 'vue';\nexport default {\n  __name: 'RoleManager',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const rolerList = ref([]);\n    const total = ref(0);\n    function queryRoleList(pageNum) {\n      axios.get(\"http://localhost:8081/rolerList?pageNum=\" + pageNum).then(response => {\n        rolerList.value = response.data.rolerList;\n        total.value = response.data.total;\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    onMounted(function () {\n      queryRoleList(1);\n    });\n    function rolerPageChange(page) {\n      queryRoleList(page);\n    }\n    function handleEdit(row) {\n      row.edit = true;\n    }\n    function handleSave(row) {\n      axios.post(\"http://localhost:8081/updateRoler\", row).then(response => {\n        if (response.data.code == 200) {\n          row.edit = false;\n        }\n        ElMessage(response.data.msg);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    const dialogRolerVisible = ref(false);\n    const rolerForm = reactive({\n      rname: '',\n      rdesc: ''\n    });\n    function openRolerDialog() {\n      dialogRolerVisible.value = true;\n    }\n    function saveRoleForm() {\n      axios.post(\"http://localhost:8081/saveRoler\", rolerForm).then(response => {\n        if (response.data.code == 200) {\n          dialogRolerVisible.value = false;\n          rolerForm.rname = '';\n          rolerForm.rdesc = '';\n        }\n        ElMessage(response.data.msg);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    function deleteRoler(id) {\n      axios.get(\"http://localhost:8081/delRoler?id=\" + id).then(response => {\n        if (response.data.code == 200) {\n          ElMessage(response.data.msg);\n          queryRoleList(1);\n        } else {\n          ElMessage(response.data.msg);\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n    const dialogRolerMenusVisible = ref(false);\n    const props = {\n      id: 'id',\n      label: 'label',\n      children: 'subMenus'\n    };\n    function rolerAndMenus() {\n      dialogRolerMenusVisible.value = true;\n    }\n    const __returned__ = {\n      rolerList,\n      total,\n      queryRoleList,\n      rolerPageChange,\n      handleEdit,\n      handleSave,\n      dialogRolerVisible,\n      rolerForm,\n      openRolerDialog,\n      saveRoleForm,\n      deleteRoler,\n      dialogRolerMenusVisible,\n      props,\n      rolerAndMenus,\n      get axios() {\n        return axios;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      onMounted,\n      reactive,\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["axios","ElMessage","onMounted","reactive","ref","rolerList","total","queryRoleList","pageNum","get","then","response","value","data","catch","error","console","log","rolerPageChange","page","handleEdit","row","edit","handleSave","post","code","msg","dialogRolerVisible","rolerForm","rname","rdesc","openRolerDialog","saveRoleForm","deleteRoler","id","dialogRolerMenusVisible","props","label","children","rolerAndMenus"],"sources":["D:/Program/Java QP/Erp/erpfront/src/views/RoleManager.vue"],"sourcesContent":["<template>\r\n  <h2>角色管理</h2>\r\n  <div style=\"text-align: left;\">\r\n    <el-button type=\"primary\" @click=\"openRolerDialog\">添加角色</el-button>\r\n  </div>\r\n  <el-table :data=\"rolerList\" style=\"width: 100%\">\r\n    <el-table-column prop=\"id\" label=\"编号\"  />\r\n    <el-table-column prop=\"rname\" label=\"角色\" >\r\n        <template #default=\"scope\">\r\n          <el-input v-if=\"scope.row.edit\" v-model=\"scope.row.rname\"></el-input>\r\n          <span v-else>{{ scope.row.rname }}</span>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column prop=\"rdesc\" label=\"描述\" >\r\n        <template #default=\"scope\">\r\n          <el-input v-if=\"scope.row.edit\" v-model=\"scope.row.rdesc\"></el-input>\r\n          <span v-else>{{ scope.row.rdesc }}</span>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column fixed=\"right\" label=\"操作\" width=\"160\">\r\n      <template #default=\"scope\">\r\n        <el-button v-if=\"!scope.row.edit\" link type=\"primary\" size=\"small\" @click=\"handleEdit(scope.row)\">编辑</el-button>\r\n        <el-button v-else link type=\"primary\" size=\"small\" @click=\"handleSave(scope.row)\">保存</el-button>\r\n        <el-button link type=\"primary\" size=\"small\" @click=\"deleteRoler(scope.row.id)\">删除</el-button>\r\n        <el-button link type=\"primary\" size=\"small\" @click=\"rolerAndMenus(scope.row)\">授权</el-button>\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n  <hr/>\r\n   <el-pagination\r\n    :page-size=\"6\"\r\n    :pager-count=\"10\"\r\n    layout=\"prev, pager, next\"\r\n    :total=\"total\"\r\n    class=\"mt-4\" @current-change=\"rolerPageChange\"\r\n  />\r\n\r\n   <el-dialog\r\n      v-model=\"dialogRolerVisible\"\r\n      width=\"80%\"\r\n  >\r\n  <h2>角色信息</h2>\r\n  <el-form :model=\"rolerForm\" label-width=\"120px\">\r\n    <el-form-item label=\"角色名称\">\r\n      <el-input v-model=\"rolerForm.rname\" style=\"width: 80%\" />\r\n    </el-form-item>\r\n    <el-form-item label=\"角色描述\">\r\n      <el-input v-model=\"rolerForm.rdesc\" style=\"width: 80%\" /> \r\n    </el-form-item>\r\n\r\n        <el-form-item>\r\n      <el-button type=\"primary\" @click=\"saveRoleForm\">保存</el-button>\r\n      <el-button>取消</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n  </el-dialog>\r\n\r\n  <el-dialog\r\n      v-model=\"dialogRolerMenusVisible\"\r\n      width=\"80%\"\r\n  >\r\n  <h2>角色授权</h2>\r\n\r\n    <el-tree\r\n      :props=\"props\"\r\n      show-checkbox\r\n    />\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport axios from 'axios';\r\nimport { ElMessage } from 'element-plus';\r\nimport { onMounted,reactive,ref} from 'vue';\r\n\r\nconst rolerList=ref([]);\r\nconst total=ref(0);\r\n\r\nfunction queryRoleList(pageNum) {\r\n    axios.get(\"http://localhost:8081/rolerList?pageNum=\"+pageNum)\r\n    .then((response)=>{\r\n        rolerList.value = response.data.rolerList;\r\n        total.value=response.data.total;\r\n    })   \r\n    .catch((error)=>{\r\n        console.log(error);\r\n    })\r\n}\r\n\r\n onMounted(function() {\r\n    queryRoleList(1);\r\n})\r\n\r\nfunction rolerPageChange(page) {\r\n    queryRoleList(page);\r\n}\r\n\r\n function handleEdit(row){\r\n    row.edit=true\r\n }\r\n \r\n function handleSave(row){\r\n    axios.post(\"http://localhost:8081/updateRoler\",row)\r\n    .then((response)=>{\r\n        if(response.data.code==200){\r\n            row.edit=false;\r\n        }\r\n        ElMessage(response.data.msg)\r\n    })\r\n    .catch((error)=>{\r\n        console.log(error);\r\n    })\r\n }\r\n \r\nconst dialogRolerVisible=ref(false);\r\nconst rolerForm=reactive({\r\n    rname:'',\r\n    rdesc:''\r\n});\r\n\r\nfunction openRolerDialog(){\r\n    dialogRolerVisible.value=true;\r\n}\r\n\r\nfunction saveRoleForm(){\r\n    axios.post(\"http://localhost:8081/saveRoler\",rolerForm)\r\n    .then((response)=>{\r\n        if(response.data.code==200){\r\n            dialogRolerVisible.value=false;\r\n            rolerForm.rname='';\r\n            rolerForm.rdesc='';\r\n        }\r\n        ElMessage(response.data.msg)\r\n    })\r\n    .catch((error)=>{\r\n        console.log(error);\r\n    })\r\n}\r\n\r\nfunction deleteRoler(id){\r\n    axios.get(\"http://localhost:8081/delRoler?id=\"+id)\r\n    .then((response)=>{\r\n      if(response.data.code==200){\r\n        ElMessage(response.data.msg)\r\n        queryRoleList(1)\r\n      }else{\r\n        ElMessage(response.data.msg)\r\n      }\r\n    })\r\n    .catch((error)=>{\r\n        console.log(error);\r\n    })\r\n}\r\n\r\nconst dialogRolerMenusVisible=ref(false);\r\nconst props = {\r\n  id: 'id',\r\n  label: 'label',\r\n  children: 'subMenus'\r\n}\r\nfunction rolerAndMenus(){\r\n    dialogRolerMenusVisible.value=true;\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}