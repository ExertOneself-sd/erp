{"ast":null,"code":"import axios from 'axios';\nimport * as echarts from 'echarts';\nimport { ref, onMounted, onUnmounted, nextTick } from 'vue';\nexport default {\n  __name: 'CustomerArea',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const chartRef = ref(null);\n    let myChart = null;\n\n    // 获取客户地区数据\n    const fetchCustomerData = async () => {\n      try {\n        const response = await axios.get(\"http://localhost:8081/countCust\");\n        return response.data || [];\n      } catch (error) {\n        console.error('获取客户数据失败:', error);\n        return [];\n      }\n    };\n\n    // 初始化图表\n    const initChart = async () => {\n      if (!chartRef.value) return;\n\n      // 销毁旧实例防止内存泄漏\n      if (myChart) {\n        myChart.dispose();\n      }\n\n      // 等待DOM渲染完成\n      await nextTick();\n\n      // 初始化图表\n      myChart = echarts.init(chartRef.value);\n\n      // 获取数据\n      const data = await fetchCustomerData();\n\n      // 图表配置\n      const option = {\n        title: {\n          text: '客户地区分布',\n          left: 'center',\n          textStyle: {\n            fontSize: 16,\n            fontWeight: 'normal'\n          }\n        },\n        tooltip: {\n          trigger: 'item',\n          formatter: '{a} <br/>{b}: {c} ({d}%)'\n        },\n        legend: {\n          type: 'scroll',\n          orient: 'vertical',\n          right: 10,\n          top: 20,\n          bottom: 20\n        },\n        toolbox: {\n          show: true,\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        series: [{\n          name: '客户数量',\n          type: 'pie',\n          radius: ['30%', '75%'],\n          center: ['40%', '50%'],\n          roseType: 'radius',\n          itemStyle: {\n            borderRadius: 5,\n            borderColor: '#fff',\n            borderWidth: 2\n          },\n          data: data.length ? data : [{\n            value: 0,\n            name: '暂无数据'\n          }],\n          label: {\n            formatter: '{b}: {d}%'\n          }\n        }]\n      };\n\n      // 设置图表选项\n      myChart.setOption(option);\n\n      // 监听窗口大小变化，自适应图表\n      window.addEventListener('resize', handleResize);\n    };\n\n    // 窗口大小变化处理\n    const handleResize = () => {\n      if (myChart) {\n        myChart.resize();\n      }\n    };\n    onMounted(() => {\n      initChart();\n    });\n    onUnmounted(() => {\n      if (myChart) {\n        myChart.dispose();\n        window.removeEventListener('resize', handleResize);\n      }\n    });\n    const __returned__ = {\n      chartRef,\n      get myChart() {\n        return myChart;\n      },\n      set myChart(v) {\n        myChart = v;\n      },\n      fetchCustomerData,\n      initChart,\n      handleResize,\n      get axios() {\n        return axios;\n      },\n      get echarts() {\n        return echarts;\n      },\n      ref,\n      onMounted,\n      onUnmounted,\n      nextTick\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["axios","echarts","ref","onMounted","onUnmounted","nextTick","chartRef","myChart","fetchCustomerData","response","get","data","error","console","initChart","value","dispose","init","option","title","text","left","textStyle","fontSize","fontWeight","tooltip","trigger","formatter","legend","type","orient","right","top","bottom","toolbox","show","feature","dataView","readOnly","restore","saveAsImage","series","name","radius","center","roseType","itemStyle","borderRadius","borderColor","borderWidth","length","label","setOption","window","addEventListener","handleResize","resize","removeEventListener"],"sources":["D:/Program/Java QP/Erp/erpfront/src/views/CustomerArea.vue"],"sourcesContent":["<template>\r\n  <div class=\"chart-container\">\r\n    <h2 class=\"text-xl font-bold mb-4\">客户地区分布</h2>\r\n    <div ref=\"chartRef\" class=\"w-full h-[500px] bg-white rounded-lg shadow-md\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport axios from 'axios';\r\nimport * as echarts from 'echarts';\r\nimport { ref, onMounted, onUnmounted, nextTick } from 'vue';\r\n\r\nconst chartRef = ref(null);\r\nlet myChart = null;\r\n\r\n// 获取客户地区数据\r\nconst fetchCustomerData = async () => {\r\n  try {\r\n    const response = await axios.get(\"http://localhost:8081/countCust\");\r\n    return response.data || [];\r\n  } catch (error) {\r\n    console.error('获取客户数据失败:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\n// 初始化图表\r\nconst initChart = async () => {\r\n  if (!chartRef.value) return;\r\n  \r\n  // 销毁旧实例防止内存泄漏\r\n  if (myChart) {\r\n    myChart.dispose();\r\n  }\r\n  \r\n  // 等待DOM渲染完成\r\n  await nextTick();\r\n  \r\n  // 初始化图表\r\n  myChart = echarts.init(chartRef.value);\r\n  \r\n  // 获取数据\r\n  const data = await fetchCustomerData();\r\n  \r\n  // 图表配置\r\n  const option = {\r\n    title: {\r\n      text: '客户地区分布',\r\n      left: 'center',\r\n      textStyle: {\r\n        fontSize: 16,\r\n        fontWeight: 'normal'\r\n      }\r\n    },\r\n    tooltip: {\r\n      trigger: 'item',\r\n      formatter: '{a} <br/>{b}: {c} ({d}%)'\r\n    },\r\n    legend: {\r\n      type: 'scroll',\r\n      orient: 'vertical',\r\n      right: 10,\r\n      top: 20,\r\n      bottom: 20,\r\n    },\r\n    toolbox: {\r\n      show: true,\r\n      feature: {\r\n        dataView: { show: true, readOnly: false },\r\n        restore: { show: true },\r\n        saveAsImage: { show: true }\r\n      }\r\n    },\r\n    series: [\r\n      {\r\n        name: '客户数量',\r\n        type: 'pie',\r\n        radius: ['30%', '75%'],\r\n        center: ['40%', '50%'],\r\n        roseType: 'radius',\r\n        itemStyle: {\r\n          borderRadius: 5,\r\n          borderColor: '#fff',\r\n          borderWidth: 2\r\n        },\r\n        data: data.length ? data : [\r\n          { value: 0, name: '暂无数据' }\r\n        ],\r\n        label: {\r\n          formatter: '{b}: {d}%'\r\n        }\r\n      }\r\n    ]\r\n  };\r\n  \r\n  // 设置图表选项\r\n  myChart.setOption(option);\r\n  \r\n  // 监听窗口大小变化，自适应图表\r\n  window.addEventListener('resize', handleResize);\r\n};\r\n\r\n// 窗口大小变化处理\r\nconst handleResize = () => {\r\n  if (myChart) {\r\n    myChart.resize();\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  initChart();\r\n});\r\n\r\nonUnmounted(() => {\r\n  if (myChart) {\r\n    myChart.dispose();\r\n    window.removeEventListener('resize', handleResize);\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.chart-container {\r\n  padding: 20px;\r\n}\r\n</style>    "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}